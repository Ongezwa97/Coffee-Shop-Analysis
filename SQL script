SELECT 
PRODUCT_CATEGORY, 
STORE_LOCATION,
MONTHNAME(TRANSACTION_DATE) AS Month_Name,
DAYNAME(TRANSACTION_DATE) AS Day_of_the_week,
COUNT(DISTINCT TRANSACTION_ID) AS transactions,
SUM(TRANSACTION_QTY) AS total_quantity_sold,
SUM(TRANSACTION_QTY * UNIT_PRICE) AS Total_Sales,
HOUR(TRANSACTION_TIME) AS Hour_of_day,
MIN(TRANSACTION_TIME),
MAX(TRANSACTION_TIME),
CASE
    WHEN TRANSACTION_TIME BETWEEN TIME '05:00:00' AND TIME '11:59:59' THEN 'Morning'
    WHEN TRANSACTION_TIME BETWEEN TIME '12:00:00' AND TIME '16:59:59' THEN 'Afternoon'
    WHEN TRANSACTION_TIME BETWEEN TIME '17:00:00' AND TIME '20:59:59' THEN 'Evening'
                ELSE 'Night'
END AS Time_Bracket,
CASE
    WHEN TRANSACTION_QTY = 1 THEN 'Single Item'
    WHEN TRANSACTION_QTY BETWEEN 2 AND 4 THEN 'Small Order'
    WHEN TRANSACTION_QTY > 4 THEN 'Bulk Order'
END AS Order_Category,
CASE
    WHEN PRODUCT_CATEGORY = 'Coffee' THEN 'Primary Product'
    WHEN PRODUCT_CATEGORY = 'Tea' THEN 'Secondary Product'
    ELSE 'Add_on_product'
END AS Product_Group,
FROM BRIGHTCOFFEESHOP.COFFEESHOP.TRANSACTIONS
GROUP BY  
STORE_LOCATION,
PRODUCT_CATEGORY,
PRODUCT_TYPE,
Order_Category,
Product_Group,
Time_Bracket,
Month_Name,
Day_of_the_week,
Hour_of_day;
